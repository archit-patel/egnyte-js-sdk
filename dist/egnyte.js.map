{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap df7da309f0434f4bfe9a","webpack:///./src/api/ENDPOINTS.js","webpack:///./src/core/errors/mkerr.js","webpack:///./src/core/helpers.js","webpack:///./src/core/index.js","webpack:///./src/frontend/filepicker/index.jsx","webpack:///./node_modules/hyperapp/src/index.js","webpack:///./node_modules/is-function/index.js","webpack:///./src/egnyte.browser.js","webpack:///./src/core/reqengine.js","webpack:///./src/core/errors/errorify.js","webpack:///./src/core/decorators/index.js","webpack:///./src/core/decorators/impersonate.js","webpack:///./src/core/decorators/customize.js","webpack:///./src/core/decorators/query.js","webpack:///./src/core/decorators/beforeSend.js","webpack:///./src/core/inputHandler.js","webpack:///./src/api/auth.js","webpack:///./src/api/fs.js","webpack:///./src/api/fs-browser.js","webpack:///./src/api/links.js","webpack:///./src/api/users.js","webpack:///./src/api/permissions.js","webpack:///./src/api/userperms.js","webpack:///./src/frontend/index.js","webpack:///./src/frontend/filepicker/app.jsx","webpack:///./node_modules/hyperapp/src/h.js","webpack:///./node_modules/hyperapp/src/app.js","webpack:///./src/frontend/filepicker/components.jsx","webpack:///./src/index.browser.js","webpack:///./src/defaults.js","webpack:///./node_modules/xhr/index.js","webpack:///./node_modules/global/window.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/parse-headers/parse-headers.js","webpack:///./node_modules/trim/index.js","webpack:///./node_modules/for-each/index.js","webpack:///./node_modules/xtend/immutable.js"],"names":["module","exports","helpers","require","mkerr","fields","error","Error","message","statusCode","hintDeveloper","hint","Object","assign","disallowedChars","isHTTP","encodeNameSafe","name","test","replace","encodePathComponents","path","split","map","encodeURIComponent","join","normalizeEgnyteDomain","domain","normalizeURL","url","err","console","warn","requestEngineFactory","decorators","inputHandler","plugins","Set","mkReqFunctionFactory","guarantees","apiFacadeMethod","tools","configure","input","process","instance","options","requestEngine","core","setDomain","normalizedDomain","egnyteDomainURL","API","manual","_","mkReqFunction","forEach","p","init","plug","plugin","add","filePicker","containerNode","perPage","errorify","enginePrototypeMethods","Engine","authType","token","requestHandler","httpRequest","quota","startOfTheSecond","calls","retrying","queue","queueHandler","_rollQueue","bind","prototype","createEngine","isAuthorized","getToken","setToken","externalToken","dropToken","params","obj","str","hasOwnProperty","push","length","getEndpoint","appendice","endpoint","charAt","sendRequest","opts","callback","forceNoAuth","self","requestDefaults","originalOpts","headers","timer","retry","retryHandler","timerStart","call","response","body","JSON","parse","e","retryAfter","masheryCode","handleQuota","setTimeout","RATE","onInvalidToken","auth","timerEnd","retrieveStreamFromRequest","Promise","resolve","reject","requestFunction","req","clearTimeout","to","promiseRequest","setupTiming","getTimer","timeEnd","currentWait","_quotaWaitTime","QPS","shift","now","Date","diff","isMsg","htmlMsgRegex","findMessage","result","i","psychicMessageParser","mess","nice","code","activeDecorators","reduce","optsModified","decorator","updatedOpts","execute","data","impersonate","username","email","customizeRequest","queryParams","beforeSend","originalInput","requires","key","undefined","optional","fsIdentification","fileId","folderId","handleFsIdentification","permScopeIdentification","userPerms","groupPerms","handlePermScopeIdentification","goodId","detectIncorrectId","id","toString","pathFromRoot","detectIncorrectPermScope","value","keys","permScope","ENDPOINTS","authAPI","getUserInfo","decorate","then","method","userinfo","fsAPI","get","fsmeta","versionEntryId","exists","parents","createFolder","json","move","transfer","copy","remove","storage","action","newPath","destination","fsBrowserAPI","download","fscontent","isBinary","responseType","storeFile","file","mimeType","storeFileMultipart","window","FormData","fileOrBlob","formData","append","ENDPOINTS_links","links","linksAPI","createLink","linkSetup","defaults","type","accessibility","setup","removeLink","listLink","listLinks","filters","findOne","list","ids","link","usersAPI","getById","users","getByName","filter","resources","user","permissionsApi","allow","perms","getPerms","userPermissionsApi","permsV1","qs","folder","filePickerInit","log","targetNode","root","state","listing","page","pagesTotal","actions","listFolder","folderPath","update","count","offset","Math","ceil","total_count","concat","folders","files","select","item","callbacks","selection","isSelected","cancel","events","load","view","is_folder","Folder","File"],"mappings":"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A;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA,qBAAqB,0BAA0B;AAC/C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL,wDAAwD;AACxD;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB,YAAY;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;;;ACxQA;;AAEO,IAAMsB,0BAAS,SAATA,MAAS;AAAA,QAAET,IAAF,QAAEA,IAAF;AAAA,QAAQb,OAAR,QAAQA,OAAR;AAAA,WAClB;AAAA;AAAA,UAAM,SAAS;AAAA,uBAAGA,QAAQC,UAAR,CAAmBY,KAAK/P,IAAxB,CAAH;AAAA,aAAf;AAAkD+P,aAAKnQ;AAAvD,KADkB;AAAA,CAAf;AAGA,IAAM6Q,sBAAO,SAAPA,IAAO;AAAA,QAAEV,IAAF,SAAEA,IAAF;AAAA,QAAQb,OAAR,SAAQA,OAAR;AAAA,WAChB;AAAA;AAAA,UAAM,SAAS;AAAA,uBAAGA,QAAQY,MAAR,CAAeC,KAAKjG,EAApB,CAAH;AAAA,aAAf;AAA4CiG,aAAKnQ;AAAjD,KADgB;AAAA,CAAb,C;;;;;;;;;ACLP,IAAM+B,OAAO,mBAAA7C,CAAQ,CAAR,CAAb;AACA,IAAMiO,WAAW,mBAAAjO,CAAQ,EAAR,CAAjB;;AAEAH,OAAOC,OAAP,GAAiB;AACbyD,QADa,gBACRP,eADQ,EACS+C,IADT,EACe;AACxB;AACA,YAAMrD,WAAWG,KAAKH,QAAL,CAAcjC,OAAOC,MAAP,CAAc,EAAC0D,aAAa,mBAAApE,CAAQ,EAAR,CAAd,EAAd,EAA6CiO,QAA7C,EAAuDlI,IAAvD,CAAd,CAAjB;AACArD,iBAASI,SAAT,CAAmBE,eAAnB;AACA,eAAON,QAAP;AACH;AANY,CAAjB,C;;;;;;;;;ACHA7C,OAAOC,OAAP,GAAiB;AACboH,iBAAa,IADA;AAEboB,SAAK;AAFQ,CAAjB,C;;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,KAAK;AACL,iCAAiC,SAAS;AAC1C;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;AChPA;;AAEA;AACA;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;;AAEA;;;;;;;;ACZA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;ACpBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA,C;;;;;;;AC7BA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;ACbA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC7CA;;AAEA;;AAEA;AACA;;AAEA,mBAAmB,sBAAsB;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"egnyte.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Egnyte\"] = factory();\n\telse\n\t\troot[\"Egnyte\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap df7da309f0434f4bfe9a","module.exports = {\n    \"fsmeta\": \"/v1/fs\",\n    \"fscontent\": \"/v1/fs-content\",\n    \"fschunked\": \"/v1/fs-content-chunked\",\n    \"notes\": \"/v1/notes\",\n    \"links\": \"/v1/links\",\n    \"permsV1\": \"/v1/perms\",\n    \"perms\": \"/v2/perms\",\n    \"userinfo\": \"/v1/userinfo\",\n    \"users\": \"/v2/users/\",\n    \"events\": \"/v1/events\",\n    \"search\": \"/v1/search\",\n    \"eventscursor\": \"/v1/events/cursor\",\n    \"tokenauth\": \"/puboauth/token\"\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/ENDPOINTS.js","const helpers = require(\"../helpers\")\nmodule.exports = function mkerr(fields, error){\n    error = error || Error(fields.message)\n    fields.statusCode = fields.statusCode || 0\n    helpers.hintDeveloper(fields.hint, error)\n    return Object.assign(error, fields)\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/errors/mkerr.js","const disallowedChars = /[\":<>|?*\\\\]/;\nconst isHTTP = /^https?:\\/\\//;\n\nconst helpers = {\n    encodeNameSafe (name) {\n        if (!name) {\n            throw new Error(\"No name given\");\n        }\n        if (disallowedChars.test(name)) {\n            throw new Error(\"Disallowed characters in path\");\n        }\n\n        name = name.replace(/^\\/\\//, \"/\");\n\n        return (name);\n    },\n    encodePathComponents (path) {\n        path = helpers.encodeNameSafe(path)\n        return path.split(\"/\").map(encodeURIComponent).join(\"/\").replace(/#/g,\"%23\");\n        //TODO: handle special chars not covered by this.\n    },\n    normalizeEgnyteDomain (domain) {\n        domain = helpers.normalizeURL(domain)\n        if(!isHTTP.test(domain)) {\n            domain = \"https://\" + domain\n        }\n        return domain;\n    },\n    normalizeURL(url) {\n        return (url).replace(/\\/*$/, \"\");\n    },\n    hintDeveloper(hint, err){\n        //TODO: make this optinal, by configuration or dev build\n        console && console.warn(hint, err)\n    }\n}\n\n\nmodule.exports = helpers;\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/helpers.js","\"use strict\"\nconst requestEngineFactory = require(\"./reqengine\")\nconst helpers = require(\"./helpers\")\nconst decorators = require(\"./decorators\")\nconst inputHandler = require(\"./inputHandler\")\nconst mkerr = require(\"./errors/mkerr\")\n\nconst plugins = new Set()\n\nconst mkReqFunctionFactory = tools => (guarantees, apiFacadeMethod) => input =>\n    apiFacadeMethod(tools, decorators.configure(input), inputHandler.process(input, guarantees))\n\n\nmodule.exports = {\n    instance(options){\n        const tools = {\n            requestEngine: requestEngineFactory(options),\n            helpers: helpers,\n            mkerr,\n            inputHandler\n        }\n        const core = {\n            setDomain(domain){\n                const normalizedDomain = domain? helpers.normalizeEgnyteDomain(domain) : null\n                options.egnyteDomainURL = normalizedDomain\n                core.domain = normalizedDomain\n            },\n            API:{\n                manual: tools.requestEngine\n            },\n            domain: null,\n            _:{\n                mkReqFunction: mkReqFunctionFactory(tools)\n            }\n        }\n        plugins.forEach(p=>p.init(core))\n        return core\n    },\n    plug(plugin){\n        // Set automatically deduplicates if a plugin was added twice\n        plugins.add(plugin)\n    },\n    _:{\n        helpers,\n        plugins,\n        requestEngineFactory\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/index.js","// accept input and pass to the app\nimport filePicker from \"./app.jsx\"\n\nexport function init(core) {\n    core.filePicker = (containerNode, options) => {\n        options.perPage = options.perPage || 100 \n\n        // TODO: options validation and authentication mechanisms to be added here\n        filePicker(containerNode, options, core)\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/frontend/filepicker/index.jsx","export { h } from \"./h\"\nexport { app } from \"./app\"\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/hyperapp/src/index.js\n// module id = 5\n// module chunks = 0","module.exports = isFunction\n\nvar toString = Object.prototype.toString\n\nfunction isFunction (fn) {\n  var string = toString.call(fn)\n  return string === '[object Function]' ||\n    (typeof fn === 'function' && string !== '[object RegExp]') ||\n    (typeof window !== 'undefined' &&\n     // IE8 and below\n     (fn === window.setTimeout ||\n      fn === window.alert ||\n      fn === window.confirm ||\n      fn === window.prompt))\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/is-function/index.js\n// module id = 6\n// module chunks = 0","const core = require(\"./core\");\ncore.plug(require(\"./api/auth\"));\ncore.plug(require(\"./api/fs\"));\ncore.plug(require(\"./api/fs-browser\"));\ncore.plug(require(\"./api/links\"));\ncore.plug(require(\"./api/users\"));\ncore.plug(require(\"./api/permissions\"));\ncore.plug(require(\"./api/userperms\"));\n\ncore.plug(require(\"./frontend/index\"));\nmodule.exports = require(\"./index.browser\");\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/egnyte.browser.js","var errorify = require(\"./errors/errorify\");\n\nvar enginePrototypeMethods = {};\n\nfunction Engine(options) {\n    this.authType = \"Bearer\";\n    this.options = options;\n    this.token = options.token;\n\n    this.requestHandler = options.httpRequest;\n\n    this.quota = {\n        startOfTheSecond: 0,\n        calls: 0,\n        retrying: 0\n    }\n    this.queue = [];\n\n    this.queueHandler = _rollQueue.bind(this);\n}\nEngine.prototype = enginePrototypeMethods;\n\nmodule.exports = function createEngine(options) {\n    return new Engine(options);\n}\n\n\n\n//======================================================================\n// auth\n\n\nenginePrototypeMethods.isAuthorized = function () {\n    return !!this.token;\n}\n\nenginePrototypeMethods.getToken = function () {\n    return this.token;\n}\n\nenginePrototypeMethods.setToken = function (externalToken) {\n    this.token = externalToken;\n}\n\n\nenginePrototypeMethods.dropToken = function (externalToken) {\n    this.token = null;\n}\n\n\n//======================================================================\n//request handling\nfunction params(obj) {\n    var str = [];\n    for (var p in obj) {\n        if (obj.hasOwnProperty(p)) {\n            str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\n        }\n    }\n    if (str.length) {\n        return \"?\" + str.join(\"&\");\n    } else {\n        return \"\";\n    }\n}\nenginePrototypeMethods.getEndpoint = function (appendice) {\n    var endpoint = this.options.egnyteDomainURL + \"/pubapi\";\n    if (appendice) {\n        if (appendice.charAt(0) !== \"/\") {\n            appendice = \"/\" + appendice\n        }\n        endpoint += appendice\n    }\n    return endpoint\n}\n\nenginePrototypeMethods.sendRequest = function (opts, callback, forceNoAuth) {\n    var self = this;\n    opts = Object.assign({}, self.options.requestDefaults, opts); //merging in the defaults\n    var originalOpts = Object.assign({}, opts); //just copying the object\n\n    if (this.isAuthorized() || forceNoAuth) {\n        opts.url += params(opts.params);\n        opts.headers = opts.headers || {};\n        if (!forceNoAuth) {\n            opts.headers[\"Authorization\"] = this.authType + \" \" + this.getToken();\n        }\n        if (!callback) {\n            return self.requestHandler(opts);\n        } else {\n            var timer;\n            var retry = function () {\n                self.sendRequest(originalOpts, self.retryHandler(callback, retry, timer));\n            };\n            if (self.timerStart) {\n                timer = self.timerStart();\n            }\n\n            return self.requestHandler(opts, self.retryHandler(callback, retry, timer));\n        }\n    } else {\n        callback.call(this, new Error(\"Not authorized\"), {\n            statusCode: 0\n        }, null);\n    }\n\n}\n\nenginePrototypeMethods.retryHandler = function (callback, retry, timer) {\n    var self = this;\n    return function (error, response, body) {\n        //build an error object for http errors\n        if (!error && response.statusCode >= 400 && response.statusCode < 600) {\n            error = new Error(body);\n        }\n        try {\n            //this shouldn't be required, but server sometimes responds with content-type text/plain\n            body = JSON.parse(body);\n        } catch (e) {}\n\n        if (response) {\n            var retryAfter = response.headers[\"retry-after\"];\n            var masheryCode = response.headers[\"x-mashery-error-code\"];\n            //in case headers get returned as arrays, we only expect one value\n            retryAfter = typeof retryAfter === \"array\" ? retryAfter[0] : retryAfter;\n            masheryCode = typeof masheryCode === \"array\" ? masheryCode[0] : masheryCode;\n        }\n\n        if (\n            response &&\n            self.options.handleQuota &&\n            response.statusCode === 403 &&\n            retryAfter\n        ) {\n            if (masheryCode === \"ERR_403_DEVELOPER_OVER_QPS\") {\n                //retry\n                console && console.warn(\"developer over QPS, retrying\");\n                self.quota.retrying = 1000 * ~~(retryAfter);\n                setTimeout(function () {\n                    self.quota.retrying = 0;\n                    retry();\n\n                }, self.quota.retrying);\n\n            }\n            if (masheryCode === \"ERR_403_DEVELOPER_OVER_RATE\") {\n                error.RATE = true;\n                callback.call(this, error, response, body);\n            }\n\n        } else {\n\n            if (\n                response &&\n                //Checking for failed auth responses\n                //(ノಠ益ಠ)ノ彡┻━┻\n                self.options.onInvalidToken &&\n                (\n                    response.statusCode === 401 ||\n                    (\n                        response.statusCode === 403 &&\n                        masheryCode === \"ERR_403_DEVELOPER_INACTIVE\"\n                    )\n                )\n            ) {\n                self.auth.dropToken();\n                self.options.onInvalidToken();\n            }\n            if (self.timerEnd) {\n                self.timerEnd(timer);\n            }\n            callback.call(this, error, response, body);\n        }\n    };\n}\n\nenginePrototypeMethods.retrieveStreamFromRequest = function (opts) {\n    var self = this;\n    return new Promise(function(resolve, reject){\n        var requestFunction = function () {\n\n            try {\n                var req = self.sendRequest(opts);\n                resolve(req);\n            } catch (error) {\n                reject(errorify({\n                    error: error\n                }));\n            }\n        }\n\n        if (!this.options.handleQuota) {\n            requestFunction();\n        } else {\n            //add to queue\n            this.queue.push(requestFunction);\n            //stop previous queue processing if any\n            clearTimeout(this.quota.to);\n            //start queue processing\n            this.queueHandler();\n        }\n    })\n}\n\nenginePrototypeMethods.promiseRequest = function (opts, requestHandler, forceNoAuth) {\n    var self = this;\n    return new Promise(function(resolve, reject){\n        var requestFunction = function () {\n            try {\n                var req = self.sendRequest(opts, function (error, response, body) {\n                    if (error) {\n                        reject(errorify({\n                            error: error,\n                            response: response,\n                            body: body\n                        }));\n                    } else {\n                        resolve({\n                            response: response,\n                            body: body\n                        });\n                    }\n                }, forceNoAuth);\n                requestHandler && requestHandler(req);\n            } catch (error) {\n                reject(errorify({\n                    error: error\n                }));\n            }\n        }\n        if (!self.options.handleQuota) {\n            requestFunction();\n        } else {\n            //add to queue\n            self.queue.push(requestFunction);\n            //stop previous queue processing if any\n            clearTimeout(self.quota.to);\n            //start queue processing\n            self.queueHandler();\n        }\n    })\n}\n\nenginePrototypeMethods.setupTiming = function (getTimer, timeEnd) {\n    this.timerStart = getTimer;\n    this.timerEnd = timeEnd;\n}\n\n//gets bound to this in the constructor and saved as this.queueHandler\nfunction _rollQueue() {\n    if (this.queue.length) {\n        var currentWait = _quotaWaitTime(this.quota, this.options.QPS);\n        if (currentWait === 0) {\n            var requestFunction = this.queue.shift();\n            requestFunction();\n            this.quota.calls++;\n        }\n        this.quota.to = setTimeout(this.queueHandler, currentWait);\n    }\n\n}\n\nfunction _quotaWaitTime(quota, QPS) {\n    var now = Date.now();\n    var diff = now - quota.startOfTheSecond;\n    //in the middle of retrying a denied call\n    if (quota.retrying) {\n        quota.startOfTheSecond = now + quota.retrying;\n        return quota.retrying + 1;\n    }\n    //last call was over a second ago, can start\n    if (diff > 1002) {\n        quota.startOfTheSecond = now;\n        quota.calls = 0;\n        return 0;\n    }\n    //calls limit not reached\n    if (quota.calls < QPS) {\n        return 0;\n    }\n    //calls limit reached, delay to the next second\n    return 1003 - diff;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/reqengine.js","const mkerr= require(\"./mkerr\")\n\n//making sense of all the different error message bodies\nvar isMsg = {\n    \"msg\": 1,\n    \"message\": 1,\n    \"errorMessage\": 1\n};\n\nvar htmlMsgRegex = /^\\s*<h1>([^<]*)<\\/h1>\\s*$/gi;\n\nfunction findMessage(obj) {\n    var result;\n    for (var i in obj) {\n        if (isMsg[i]) {\n            return obj[i];\n        }\n        if (typeof obj[i] === \"object\") {\n            result = findMessage(obj[i]);\n            if (result) {\n                return result;\n            }\n        }\n    }\n}\n//this should understand all the message formats from the server and translate to a nice message\nfunction psychicMessageParser(mess, statusCode) {\n    var nice;\n    if (typeof mess === \"string\") {\n        try {\n            nice = findMessage(JSON.parse(mess));\n            if (!nice) {\n                //fallback if nothing found - return raw JSON string anyway\n                nice = mess;\n            }\n        } catch (e) {\n            nice = mess ? mess.replace(htmlMsgRegex, \"$1\") : \"Unknown error\";\n        }\n        if (statusCode === 404 && mess.length > 300) {\n            //server returned a dirty 404\n            nice = \"Not found\";\n        }\n    } else {\n        nice = findMessage(mess);\n    }\n    return nice;\n}\n\nmodule.exports = function (result) {\n    var error, code;\n    if (result.response) {\n        code = ~~ (result.response.statusCode);\n        error = mkerr({\n            statusCode: code,\n            message: \"\"+psychicMessageParser(result.body||result.error.message, code),\n            response: result.response,\n            body: result.body,\n        }, result.error);\n    } else {\n        error = mkerr({\n            statusCode: 0,\n        }, result.error);\n    }\n    return error;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/errors/errorify.js","const mkerr = require(\"../errors/mkerr\")\n\n// IMPORTANT: order matters. Make sure customize is at the end and beforeSend is last\n//   so it doesn't get overwritten\nconst activeDecorators = [\n    // put more here, not below\n    require(\"./impersonate\"),\n    require(\"./customize\"),\n    require(\"./query\"),\n    require(\"./beforeSend\")\n]\n\nmodule.exports = {\n    configure(input) {\n        return (opts) => {\n            opts = activeDecorators.reduce((optsModified, decorator) => {\n                if (decorator.name in input) {\n                    const updatedOpts = decorator.execute(optsModified, input)\n                    if (!updatedOpts) {\n                        throw mkerr({\n                            message: `Decorator from ${decorator.name} didn't return the options object`\n                        })\n                    }\n                    return updatedOpts\n                } else {\n                    return optsModified\n                }\n            }, opts)\n            return opts\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/decorators/index.js","module.exports = {\n    name: \"impersonate\",\n    execute(opts, input){\n        if (!opts.headers) {\n            opts.headers = {}\n        }\n        const data = input.impersonate;\n        if (data.username) {\n            opts.headers[\"X-Egnyte-Act-As\"] = data.username;\n        }\n        if (data.email) {\n            opts.headers[\"X-Egnyte-Act-As-Email\"] = data.email;\n        }\n        return opts;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/decorators/impersonate.js","module.exports = {\n    name: \"customizeRequest\",\n    execute(opts, input){\n        return Object.assign(opts, input.customizeRequest)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/decorators/customize.js","module.exports = {\n    name: \"queryParams\",\n    execute(opts, input){\n        Object.assign(opts.params, input.queryParams)\n        return opts\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/decorators/query.js","module.exports = {\n    name: \"beforeSend\",\n    execute(opts, input){\n        return input.beforeSend(opts, input)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/decorators/beforeSend.js","const mkerr = require(\"./errors/mkerr\")\nconst helpers = require(\"./helpers\")\n\n\nmodule.exports = {\n    process(originalInput, guarantees) {\n        let input = Object.assign({}, originalInput)\n        if (guarantees.requires) {\n            guarantees.requires.forEach(key => {\n                if (input[key] === undefined) {\n                    throw mkerr({\n                        message: `Invalid input, ${key} field required`,\n                        hint: `${key} field required`\n                    })\n                }\n            })\n        }\n        if (guarantees.optional) {\n            guarantees.optional.forEach(key => {\n                if (key in input && input[key] === undefined) {\n                    helpers.hintDeveloper(`${key} field was explicitly passed an undefined value. It's likely an accident. Avoid specifying the property at all if it's undefined.`)\n                }\n            })\n        }\n        if (guarantees.fsIdentification) {\n            if (!(input.fileId || input.folderId || input.path)) {\n                throw mkerr({\n                    message: `Identify a file or folder. One of the fields must be specified: fileId folderId path`,\n                    hint: `Identify a file or folder. One of the fields must be specified: fileId folderId path`\n                })\n            } else {\n                input = handleFsIdentification(input)\n            }\n        }\n        if (guarantees.permScopeIdentification) {\n            if (!(input.userPerms || input.groupPerms)) {\n                throw mkerr({\n                    message: `Identify a user and group. One or more of the fields must be specified: userPerms groupPerms`,\n                    hint: `Identify a user and group. One or more of the fields must be specified: userPerms groupPerms`\n                })\n            } else {\n                input = handlePermScopeIdentification(input)\n            }\n        }\n        return input\n    }\n}\n\nconst goodId = /^[0-9a-z\\-]+$/i\nfunction detectIncorrectId(key, id){\n    if(!goodId.test(id)){\n        throw mkerr({\n            message: `Invalid file or folder identification, ${key} field seems to contain something else than an ID`,\n            hint: `${key} field expected to match ${goodId.toString()}`\n        })\n    }\n}\n\nfunction handleFsIdentification(input){\n    if(input.fileId){\n        detectIncorrectId(\"fileId\", input.fileId)\n        input.pathFromRoot = \"/ids/file/\"+input.fileId\n        return input\n    }\n    if(input.folderId){\n        detectIncorrectId(\"folderId\", input.folderId)\n        input.pathFromRoot = \"/ids/file/\"+input.folderId\n        return input\n    }\n    if(input.path){\n        input.pathFromRoot = helpers.encodePathComponents(input.path)\n        return input\n    }\n}\n\nfunction detectIncorrectPermScope (key, value) {\n    if (!value || typeof value !== \"object\" || Object.keys(value).length === 0) {\n        throw mkerr({\n            message: `Invalid permission scope identification, ${key} field should be an non empty object`,\n            hint: `Invalid permission scope identification, ${key} field should be an non empty object`\n        })\n    }\n}\n\nfunction handlePermScopeIdentification (input) {\n    input.permScope = {};\n    if(input.userPerms){\n        detectIncorrectPermScope(\"userPerms\", input.userPerms);\n        input.permScope.userPerms = input.userPerms\n\n    }\n    if(input.groupPerms){\n        detectIncorrectPermScope(\"groupPerms\", input.groupPerms);\n        input.permScope.groupPerms = input.groupPerms\n    }\n    return input;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/inputHandler.js","const ENDPOINTS = require(\"./ENDPOINTS\");\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction\n        const authAPI = {\n            getUserInfo: mkReqFunction({}, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        var opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.userinfo),\n                        };\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body);\n            }),\n            isAuthorized: mkReqFunction({}, (tools) =>\n                tools.requestEngine.isAuthorized()\n            ),\n\n        }\n\n        core.API.auth = authAPI\n        return authAPI\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/auth.js","const ENDPOINTS = require(\"./ENDPOINTS\");\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction\n        const fsAPI = {\n            get: mkReqFunction({\n                fsIdentification: true,\n                optional: [\"versionEntryId\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fsmeta + input.pathFromRoot),\n                        };\n\n                        if (input.versionEntryId) {\n                            opts.params = {\n                                \"entry_id\": input.versionEntryId\n                            };\n                        }\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body);\n            }),\n            exists: mkReqFunction({\n                fsIdentification: true\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fsmeta + input.pathFromRoot),\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(\n                        result => (result.response.statusCode == 200), //breaking change\n                        result => { //result.error result.response, result.body\n                            if (result.response && result.response.statusCode == 404) {\n                                return false;\n                            } else {\n                                throw result;\n                            }\n                        }\n                    );\n            }),\n            parents: mkReqFunction({\n                fsIdentification: true\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fsmeta + input.pathFromRoot + \"/parents\")\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body);\n\n            }),\n            createFolder: mkReqFunction({\n                fsIdentification: true\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"POST\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fsmeta + input.pathFromRoot),\n                            json: {\n                                \"action\": \"add_folder\"\n                            }\n                        }\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body); //breaking change\n\n            }),\n            //breaking change - no more rename, can be implemented properly later\n            move: mkReqFunction({\n                fsIdentification: true,\n                requires: [\"destination\"]\n            }, transfer.bind(null, \"move\")),\n            copy: mkReqFunction({\n                fsIdentification: true,\n                requires: [\"destination\"]\n            }, transfer.bind(null, \"copy\")),\n            remove: mkReqFunction({\n                fsIdentification: true,\n                optional: [\"versionEntryId\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"DELETE\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fsmeta + input.pathFromRoot),\n                        };\n                        if (input.versionEntryId) {\n                            opts.params = {\n                                \"entry_id\": versionEntryId\n                            };\n                        }\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.response.statusCode); //backwards commpatibility\n\n            }),\n        }\n\n        core.API.storage = fsAPI\n        return fsAPI\n    }\n}\n\n\nfunction transfer(action, tools, decorate, input) {\n    return Promise.resolve()\n        .then(() => {\n            const newPath = tools.helpers.encodeNameSafe(input.destination);\n            const opts = {\n                method: \"POST\",\n                url: tools.requestEngine.getEndpoint(ENDPOINTS.fsmeta + input.pathFromRoot),\n                json: {\n                    \"action\": action,\n                    \"destination\": newPath,\n                }\n            };\n            return tools.requestEngine.promiseRequest(decorate(opts));\n        })\n        .then(result => result.body); //breaking change\n    // .then(function (result) { //result.response result.body\n    //     if (result.response.statusCode == 200) {\n    //         return {\n    //             oldPath: pathFromRoot,\n    //             path: newPath\n    //         };\n    //     }\n    // });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/fs.js","const ENDPOINTS = require(\"./ENDPOINTS\");\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction\n        const fsBrowserAPI = {\n            download: mkReqFunction({\n                fsIdentification: true,\n                optional: [\"versionEntryId\", \"isBinary\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fscontent + input.pathFromRoot),\n                        };\n                        if (input.versionEntryId) {\n                            opts.params = {\n                                \"entry_id\": input.versionEntryId\n                            };\n                        }\n\n                        if (input.isBinary) {\n                            opts.responseType = \"arraybuffer\";\n                        }\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.response);\n            }),\n            storeFile: mkReqFunction({\n                fsIdentification: true,\n                requires: [\"file\"],\n                optional: [\"mimeType\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n\n                        const opts = {\n                            method: \"POST\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fscontent + input.pathFromRoot),\n                            body: input.file,\n                        }\n\n                        opts.headers = {};\n                        if (input.mimeType) {\n                            opts.headers[\"Content-Type\"] = input.mimeType;\n                        }\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => {\n                        result.body.id = result.response.headers[\"etag\"] //for backward compatibility\n                        return result.body\n                    });\n            }),\n            //TODO: check if EOS supports this\n            storeFileMultipart: mkReqFunction({\n                fsIdentification: true,\n                requires: [\"file\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        if (!window.FormData) {\n                            throw new Error(\"Unsupported browser\");\n                        }\n                        var file = fileOrBlob;\n                        var formData = new window.FormData();\n                        formData.append('file', file);\n                        pathFromRoot = helpers.encodeNameSafe(pathFromRoot) || \"\";\n                        var opts = {\n                            method: \"POST\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.fscontent + input.pathFromRoot),\n                            body: formData,\n                        };\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => {\n                        result.body.id = result.response.headers[\"etag\"] //for backward compatibility\n                        return result.body\n                    });\n            }),\n\n        }\n\n        core.API.storage = Object.assign(core.API.storage, fsBrowserAPI)\n        return fsBrowserAPI\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/fs-browser.js","const ENDPOINTS_links = require(\"./ENDPOINTS\").links;\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction\n        const linksAPI = {\n            createLink: mkReqFunction({\n                requires: [\"path\", \"linkSetup\"],\n                fsIdentification: true\n            }, (tools, decorate, input) => {\n                const linkSetup = input.linkSetup\n                const defaults = {\n                    path: null,\n                    type: \"file\",\n                    accessibility: \"domain\"\n                };\n                return Promise.resolve()\n                    .then(() => {\n                        const setup = Object.assign(defaults, linkSetup, {\n                            path: input.pathFromRoot\n                        });\n                        // setup.path = tools.encodeNameSafe(setup.path);\n\n                        return tools.requestEngine.promiseRequest(decorate({\n                            method: \"POST\",\n                            url: tools.requestEngine.getEndpoint() + ENDPOINTS_links,\n                            json: setup\n                        }));\n                    }).then(function (result) { //result.response result.body\n                        return result.body;\n                    });\n            }),\n            removeLink: mkReqFunction({\n                requires: [\"id\"]\n            }, (tools, decorate, input) => {\n                return tools.requestEngine.promiseRequest(decorate({\n                    method: \"DELETE\",\n                    url: tools.requestEngine.getEndpoint() + ENDPOINTS_links + \"/\" + input.id\n                })).then(function (result) { //result.response result.body\n                    return result.response.statusCode;\n                });\n            }),\n            listLink: mkReqFunction({\n                requires: [\"id\"]\n            }, (tools, decorate, input) => {\n                return tools.requestEngine.promiseRequest(decorate({\n                    method: \"GET\",\n                    url: tools.requestEngine.getEndpoint() + ENDPOINTS_links + \"/\" + input.id\n                })).then(function (result) { //result.response result.body\n                    return result.body;\n                });\n            }),\n            listLinks: mkReqFunction({\n                requires: [\"filters\"]\n            }, (tools, decorate, input) => {\n                const filters = input.filters\n                return Promise.resolve()\n                    .then(function () {\n                        filters.path = filters.path && tools.helpers.encodeNameSafe(filters.path);\n\n                        return tools.requestEngine.promiseRequest(decorate({\n                            method: \"get\",\n                            url: tools.requestEngine.getEndpoint() + ENDPOINTS_links,\n                            params: filters\n                        }));\n                    }).then(function (result) { //result.response result.body\n                        return result.body;\n                    });\n            }),\n            findOne: mkReqFunction({\n                requires: [\"filters\"]\n            }, (tools, decorate, input) => {\n                return linksAPI.listLinks(input).then(function (list) {\n                    if (list.ids && list.ids.length > 0) {\n                        return linksAPI.listLink({\n                            id: list.ids[0]\n                        });\n                    } else {\n                        return null;\n                    }\n                });\n            }),\n        }\n\n        core.API.link = linksAPI\n        return linksAPI\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/links.js","const ENDPOINTS = require(\"./ENDPOINTS\");\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction;\n        const usersAPI = {\n            getById: mkReqFunction({\n                fsIdentification: false,\n                requires: [\"id\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        let opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.users + input.id),\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body);\n            }),\n            getByName: mkReqFunction({\n                fsIdentification: false,\n                requires: [\"name\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        let opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.users),\n                            params: {\n                                filter: \"userName eq \\\"\" + input.name + \"\\\"\"\n                            }\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => {\n                        if(result.body.resources && result.body.resources[0]){\n                            return result.body.resources[0];\n                        } else {\n                            throw tools.mkerr({\n                                message: `User not found`\n                            });\n                        }\n                    });\n            }),\n        };\n\n        core.API.user = usersAPI;\n        return usersAPI\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/users.js","const ENDPOINTS = require(\"./ENDPOINTS\");\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction;\n        const permissionsApi = {\n            allow: mkReqFunction({\n                fsIdentification: true,\n                permScopeIdentification: true\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"POST\",\n                            json: input.permScope,\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.perms + input.pathFromRoot),\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.response.statusCode);\n            }),\n            getPerms: mkReqFunction({\n                fsIdentification: true\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.perms + input.pathFromRoot)\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body);\n            })\n        }\n\n        core.API.perms = permissionsApi;\n        return permissionsApi\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/permissions.js","const ENDPOINTS = require(\"./ENDPOINTS\");\n\nmodule.exports = {\n    init(core) {\n        const mkReqFunction = core._.mkReqFunction\n        const userPermissionsApi = {\n            get: mkReqFunction({\n                fsIdentification: true,\n                optional: [\"username\"]\n            }, (tools, decorate, input) => {\n                return Promise.resolve()\n                    .then(() => {\n                        const opts = {\n                            method: \"GET\",\n                            url: tools.requestEngine.getEndpoint(ENDPOINTS.permsV1 + \"/user\" + (input.username ? \"/\" + input.username : \"\"))\n                        };\n                        opts.params = opts.qs = {\n                            folder: input.pathFromRoot\n                        };\n\n                        return tools.requestEngine.promiseRequest(decorate(opts));\n                    })\n                    .then(result => result.body);\n            }),\n\n        }\n\n        core.API.userPerms = userPermissionsApi;\n        return userPermissionsApi\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/userperms.js","const filePickerInit = require(\"./filepicker/index.jsx\").init\nconsole.log(require(\"./filepicker/index.jsx\"))\nmodule.exports = {\n    init(core) {\n        filePickerInit(core)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/frontend/index.js","import {h, app} from \"hyperapp\"\nimport {Folder, File} from \"./components.jsx\"\n\nexport default function init(targetNode, options, core) {\n\n    app({\n        root: targetNode,\n        state: {\n            path: options.path || \"/\",\n            listing: [],\n            page: 1,\n            pagesTotal: 0\n        },\n        actions: {\n            listFolder(state, actions, folderPath) {\n                const path = folderPath || state.path\n                return update => {\n                    update(Object.assign(state, {path: path}))\n                    core.API.storage.get({\n                        path: state.path,\n                        count: options.perPage,\n                        offset: state.page - 1\n                    }).then(folder => {\n                        update(Object.assign(state, {\n                            pagesTotal: Math.ceil(folder.total_count / options.perPage),\n                            listing: [].concat(folder.folders, folder.files)\n                        }))\n                    })\n                }\n            },\n            select(state, actions, item){\n\n            },\n            callbacks: {\n                selection: () => {\n                    options.selection(state.listing.filter(i=>i.isSelected))\n                },\n                cancel: () => {\n                    options.cancel()\n                },\n                error: (state, actions, error) => {\n                    options.error(error)\n                }\n            }\n        },\n        events: {\n            load(state, actions) {\n                actions.listFolder()\n            }\n        },\n        view: (state, actions) => (\n            <div class=\"eg-filepicker\">\n                {state.listing.map(item => item.is_folder\n                    ? <Folder item={item} actions={actions}/>\n                    : <File item={item} actions={actions}/>)}\n            </div>\n        )\n    })\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/frontend/filepicker/app.jsx","var i\nvar stack = []\n\nexport function h(tag, data) {\n  var node\n  var children = []\n\n  for (i = arguments.length; i-- > 2; ) {\n    stack.push(arguments[i])\n  }\n\n  while (stack.length) {\n    if (Array.isArray((node = stack.pop()))) {\n      for (i = node.length; i--; ) {\n        stack.push(node[i])\n      }\n    } else if (node != null && node !== true && node !== false) {\n      if (typeof node === \"number\") {\n        node = node + \"\"\n      }\n      children.push(node)\n    }\n  }\n\n  return typeof tag === \"string\"\n    ? {\n        tag: tag,\n        data: data || {},\n        children: children\n      }\n    : tag(data, children)\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/hyperapp/src/h.js\n// module id = 25\n// module chunks = 0","var globalInvokeLaterStack = []\n\nexport function app(props) {\n  var appState\n  var appView = props.view\n  var appActions = {}\n  var appEvents = {}\n  var appMixins = props.mixins || []\n  var appRoot = props.root || document.body\n  var element = appRoot.children[0]\n  var oldNode\n  var willRender\n\n  for (var i = 0; i <= appMixins.length; i++) {\n    var mixin = appMixins[i] ? appMixins[i](emit) : props\n\n    Object.keys(mixin.events || []).map(function(key) {\n      appEvents[key] = (appEvents[key] || []).concat(mixin.events[key])\n    })\n\n    initialize(appActions, mixin.actions)\n    appState = merge(appState, mixin.state)\n  }\n\n  requestRender(\n    (oldNode = emit(\"load\", element)) === element && (oldNode = element = null)\n  )\n\n  return emit\n\n  function initialize(actions, withActions, lastName) {\n    Object.keys(withActions || []).map(function(key) {\n      var action = withActions[key]\n      var name = lastName ? lastName + \".\" + key : key\n\n      if (typeof action === \"function\") {\n        actions[key] = function(data) {\n          emit(\"action\", { name: name, data: data })\n\n          var result = emit(\"resolve\", action(appState, appActions, data))\n\n          return typeof result === \"function\" ? result(update) : update(result)\n        }\n      } else {\n        initialize(actions[key] || (actions[key] = {}), action, name)\n      }\n    })\n  }\n\n  function render(cb) {\n    element = patch(\n      appRoot,\n      element,\n      oldNode,\n      (oldNode = emit(\"render\", appView)(appState, appActions)),\n      (willRender = !willRender)\n    )\n    while ((cb = globalInvokeLaterStack.pop())) cb()\n  }\n\n  function requestRender() {\n    if (appView && !willRender) {\n      requestAnimationFrame(render, (willRender = !willRender))\n    }\n  }\n\n  function update(withState) {\n    if (withState && (withState = emit(\"update\", merge(appState, withState)))) {\n      requestRender((appState = withState))\n    }\n    return appState\n  }\n\n  function emit(name, data) {\n    return (appEvents[name] || []).map(function(cb) {\n      var result = cb(appState, appActions, data)\n      if (result != null) {\n        data = result\n      }\n    }), data\n  }\n\n  function merge(a, b) {\n    var obj = {}\n\n    for (var i in a) {\n      obj[i] = a[i]\n    }\n\n    for (var i in b) {\n      obj[i] = b[i]\n    }\n\n    return obj\n  }\n\n  function getKey(node) {\n    if (node && (node = node.data)) {\n      return node.key\n    }\n  }\n\n  function createElement(node, isSVG) {\n    if (typeof node === \"string\") {\n      var element = document.createTextNode(node)\n    } else {\n      var element = (isSVG = isSVG || node.tag === \"svg\")\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", node.tag)\n        : document.createElement(node.tag)\n\n      if (node.data && node.data.oncreate) {\n        globalInvokeLaterStack.push(function() {\n          node.data.oncreate(element)\n        })\n      }\n\n      for (var i in node.data) {\n        setData(element, i, node.data[i])\n      }\n\n      for (var i = 0; i < node.children.length; ) {\n        element.appendChild(createElement(node.children[i++], isSVG))\n      }\n    }\n\n    return element\n  }\n\n  function setData(element, name, value, oldValue) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in merge(oldValue, (value = value || {}))) {\n        element.style[i] = value[i] || \"\"\n      }\n    } else {\n      try {\n        element[name] = value\n      } catch (_) {}\n\n      if (typeof value !== \"function\") {\n        if (value) {\n          element.setAttribute(name, value)\n        } else {\n          element.removeAttribute(name)\n        }\n      }\n    }\n  }\n\n  function updateElement(element, oldData, data) {\n    for (var i in merge(oldData, data)) {\n      var value = data[i]\n      var oldValue = i === \"value\" || i === \"checked\" ? element[i] : oldData[i]\n\n      if (value !== oldValue) {\n        setData(element, i, value, oldValue)\n      }\n    }\n\n    if (data && data.onupdate) {\n      globalInvokeLaterStack.push(function() {\n        data.onupdate(element, oldData)\n      })\n    }\n  }\n\n  function removeElement(parent, element, data) {\n    if (data && data.onremove) {\n      data.onremove(element)\n    } else {\n      parent.removeChild(element)\n    }\n  }\n\n  function patch(parent, element, oldNode, node, isSVG, nextSibling) {\n    if (oldNode == null) {\n      element = parent.insertBefore(createElement(node, isSVG), element)\n    } else if (node.tag != null && node.tag === oldNode.tag) {\n      updateElement(element, oldNode.data, node.data)\n\n      isSVG = isSVG || node.tag === \"svg\"\n\n      var len = node.children.length\n      var oldLen = oldNode.children.length\n      var oldKeyed = {}\n      var oldElements = []\n      var keyed = {}\n\n      for (var i = 0; i < oldLen; i++) {\n        var oldElement = (oldElements[i] = element.childNodes[i])\n        var oldChild = oldNode.children[i]\n        var oldKey = getKey(oldChild)\n\n        if (null != oldKey) {\n          oldKeyed[oldKey] = [oldElement, oldChild]\n        }\n      }\n\n      var i = 0\n      var j = 0\n\n      while (j < len) {\n        var oldElement = oldElements[i]\n        var oldChild = oldNode.children[i]\n        var newChild = node.children[j]\n\n        var oldKey = getKey(oldChild)\n        if (keyed[oldKey]) {\n          i++\n          continue\n        }\n\n        var newKey = getKey(newChild)\n\n        var keyedNode = oldKeyed[newKey] || []\n\n        if (null == newKey) {\n          if (null == oldKey) {\n            patch(element, oldElement, oldChild, newChild, isSVG)\n            j++\n          }\n          i++\n        } else {\n          if (oldKey === newKey) {\n            patch(element, keyedNode[0], keyedNode[1], newChild, isSVG)\n            i++\n          } else if (keyedNode[0]) {\n            element.insertBefore(keyedNode[0], oldElement)\n            patch(element, keyedNode[0], keyedNode[1], newChild, isSVG)\n          } else {\n            patch(element, oldElement, null, newChild, isSVG)\n          }\n\n          j++\n          keyed[newKey] = newChild\n        }\n      }\n\n      while (i < oldLen) {\n        var oldChild = oldNode.children[i]\n        var oldKey = getKey(oldChild)\n        if (null == oldKey) {\n          removeElement(element, oldElements[i], oldChild.data)\n        }\n        i++\n      }\n\n      for (var i in oldKeyed) {\n        var keyedNode = oldKeyed[i]\n        var reusableNode = keyedNode[1]\n        if (!keyed[reusableNode.data.key]) {\n          removeElement(element, keyedNode[0], reusableNode.data)\n        }\n      }\n    } else if (element && node !== element.nodeValue) {\n      element = parent.insertBefore(\n        createElement(node, isSVG),\n        (nextSibling = element)\n      )\n      removeElement(parent, nextSibling, oldNode.data)\n    }\n\n    return element\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/hyperapp/src/app.js\n// module id = 26\n// module chunks = 0","import {h} from \"hyperapp\"\n\nexport const Folder = ({item, actions}) => (\n    <span onclick={_=>actions.listFolder(item.path)}>{item.name}</span>\n)\nexport const File = ({item, actions}) => (\n    <span onclick={_=>actions.select(item.id)}>{item.name}</span>\n)\n\n\n\n// WEBPACK FOOTER //\n// ./src/frontend/filepicker/components.jsx","const core = require(\"./core\")\nconst defaults = require(\"./defaults.js\");\n\nmodule.exports = {\n    init(egnyteDomainURL, opts) {\n        //TODO: plug in httpRequest depending on env\n        const instance = core.instance(Object.assign({httpRequest: require(\"xhr\")}, defaults, opts))\n        instance.setDomain(egnyteDomainURL)\n        return instance\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.browser.js","module.exports = {\n    handleQuota: true,\n    QPS: 2\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/defaults.js","\"use strict\";\nvar window = require(\"global/window\")\nvar isFunction = require(\"is-function\")\nvar parseHeaders = require(\"parse-headers\")\nvar xtend = require(\"xtend\")\n\nmodule.exports = createXHR\ncreateXHR.XMLHttpRequest = window.XMLHttpRequest || noop\ncreateXHR.XDomainRequest = \"withCredentials\" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest\n\nforEachArray([\"get\", \"put\", \"post\", \"patch\", \"head\", \"delete\"], function(method) {\n    createXHR[method === \"delete\" ? \"del\" : method] = function(uri, options, callback) {\n        options = initParams(uri, options, callback)\n        options.method = method.toUpperCase()\n        return _createXHR(options)\n    }\n})\n\nfunction forEachArray(array, iterator) {\n    for (var i = 0; i < array.length; i++) {\n        iterator(array[i])\n    }\n}\n\nfunction isEmpty(obj){\n    for(var i in obj){\n        if(obj.hasOwnProperty(i)) return false\n    }\n    return true\n}\n\nfunction initParams(uri, options, callback) {\n    var params = uri\n\n    if (isFunction(options)) {\n        callback = options\n        if (typeof uri === \"string\") {\n            params = {uri:uri}\n        }\n    } else {\n        params = xtend(options, {uri: uri})\n    }\n\n    params.callback = callback\n    return params\n}\n\nfunction createXHR(uri, options, callback) {\n    options = initParams(uri, options, callback)\n    return _createXHR(options)\n}\n\nfunction _createXHR(options) {\n    if(typeof options.callback === \"undefined\"){\n        throw new Error(\"callback argument missing\")\n    }\n\n    var called = false\n    var callback = function cbOnce(err, response, body){\n        if(!called){\n            called = true\n            options.callback(err, response, body)\n        }\n    }\n\n    function readystatechange() {\n        if (xhr.readyState === 4) {\n            setTimeout(loadFunc, 0)\n        }\n    }\n\n    function getBody() {\n        // Chrome with requestType=blob throws errors arround when even testing access to responseText\n        var body = undefined\n\n        if (xhr.response) {\n            body = xhr.response\n        } else {\n            body = xhr.responseText || getXml(xhr)\n        }\n\n        if (isJson) {\n            try {\n                body = JSON.parse(body)\n            } catch (e) {}\n        }\n\n        return body\n    }\n\n    function errorFunc(evt) {\n        clearTimeout(timeoutTimer)\n        if(!(evt instanceof Error)){\n            evt = new Error(\"\" + (evt || \"Unknown XMLHttpRequest Error\") )\n        }\n        evt.statusCode = 0\n        return callback(evt, failureResponse)\n    }\n\n    // will load the data & process the response in a special response object\n    function loadFunc() {\n        if (aborted) return\n        var status\n        clearTimeout(timeoutTimer)\n        if(options.useXDR && xhr.status===undefined) {\n            //IE8 CORS GET successful response doesn't have a status field, but body is fine\n            status = 200\n        } else {\n            status = (xhr.status === 1223 ? 204 : xhr.status)\n        }\n        var response = failureResponse\n        var err = null\n\n        if (status !== 0){\n            response = {\n                body: getBody(),\n                statusCode: status,\n                method: method,\n                headers: {},\n                url: uri,\n                rawRequest: xhr\n            }\n            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE\n                response.headers = parseHeaders(xhr.getAllResponseHeaders())\n            }\n        } else {\n            err = new Error(\"Internal XMLHttpRequest Error\")\n        }\n        return callback(err, response, response.body)\n    }\n\n    var xhr = options.xhr || null\n\n    if (!xhr) {\n        if (options.cors || options.useXDR) {\n            xhr = new createXHR.XDomainRequest()\n        }else{\n            xhr = new createXHR.XMLHttpRequest()\n        }\n    }\n\n    var key\n    var aborted\n    var uri = xhr.url = options.uri || options.url\n    var method = xhr.method = options.method || \"GET\"\n    var body = options.body || options.data\n    var headers = xhr.headers = options.headers || {}\n    var sync = !!options.sync\n    var isJson = false\n    var timeoutTimer\n    var failureResponse = {\n        body: undefined,\n        headers: {},\n        statusCode: 0,\n        method: method,\n        url: uri,\n        rawRequest: xhr\n    }\n\n    if (\"json\" in options && options.json !== false) {\n        isJson = true\n        headers[\"accept\"] || headers[\"Accept\"] || (headers[\"Accept\"] = \"application/json\") //Don't override existing accept header declared by user\n        if (method !== \"GET\" && method !== \"HEAD\") {\n            headers[\"content-type\"] || headers[\"Content-Type\"] || (headers[\"Content-Type\"] = \"application/json\") //Don't override existing accept header declared by user\n            body = JSON.stringify(options.json === true ? body : options.json)\n        }\n    }\n\n    xhr.onreadystatechange = readystatechange\n    xhr.onload = loadFunc\n    xhr.onerror = errorFunc\n    // IE9 must have onprogress be set to a unique function.\n    xhr.onprogress = function () {\n        // IE must die\n    }\n    xhr.onabort = function(){\n        aborted = true;\n    }\n    xhr.ontimeout = errorFunc\n    xhr.open(method, uri, !sync, options.username, options.password)\n    //has to be after open\n    if(!sync) {\n        xhr.withCredentials = !!options.withCredentials\n    }\n    // Cannot set timeout with sync request\n    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly\n    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent\n    if (!sync && options.timeout > 0 ) {\n        timeoutTimer = setTimeout(function(){\n            if (aborted) return\n            aborted = true//IE9 may still call readystatechange\n            xhr.abort(\"timeout\")\n            var e = new Error(\"XMLHttpRequest timeout\")\n            e.code = \"ETIMEDOUT\"\n            errorFunc(e)\n        }, options.timeout )\n    }\n\n    if (xhr.setRequestHeader) {\n        for(key in headers){\n            if(headers.hasOwnProperty(key)){\n                xhr.setRequestHeader(key, headers[key])\n            }\n        }\n    } else if (options.headers && !isEmpty(options.headers)) {\n        throw new Error(\"Headers cannot be set on an XDomainRequest object\")\n    }\n\n    if (\"responseType\" in options) {\n        xhr.responseType = options.responseType\n    }\n\n    if (\"beforeSend\" in options &&\n        typeof options.beforeSend === \"function\"\n    ) {\n        options.beforeSend(xhr)\n    }\n\n    // Microsoft Edge browser sends \"undefined\" when send is called with undefined value.\n    // XMLHttpRequest spec says to pass null as body to indicate no body\n    // See https://github.com/naugtur/xhr/issues/100.\n    xhr.send(body || null)\n\n    return xhr\n\n\n}\n\nfunction getXml(xhr) {\n    if (xhr.responseType === \"document\") {\n        return xhr.responseXML\n    }\n    var firefoxBugTakenEffect = xhr.responseXML && xhr.responseXML.documentElement.nodeName === \"parsererror\"\n    if (xhr.responseType === \"\" && !firefoxBugTakenEffect) {\n        return xhr.responseXML\n    }\n\n    return null\n}\n\nfunction noop() {}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/xhr/index.js\n// module id = 30\n// module chunks = 0","var win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof global !== \"undefined\") {\n    win = global;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/global/window.js\n// module id = 31\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 32\n// module chunks = 0","var trim = require('trim')\n  , forEach = require('for-each')\n  , isArray = function(arg) {\n      return Object.prototype.toString.call(arg) === '[object Array]';\n    }\n\nmodule.exports = function (headers) {\n  if (!headers)\n    return {}\n\n  var result = {}\n\n  forEach(\n      trim(headers).split('\\n')\n    , function (row) {\n        var index = row.indexOf(':')\n          , key = trim(row.slice(0, index)).toLowerCase()\n          , value = trim(row.slice(index + 1))\n\n        if (typeof(result[key]) === 'undefined') {\n          result[key] = value\n        } else if (isArray(result[key])) {\n          result[key].push(value)\n        } else {\n          result[key] = [ result[key], value ]\n        }\n      }\n  )\n\n  return result\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/parse-headers/parse-headers.js\n// module id = 33\n// module chunks = 0","\nexports = module.exports = trim;\n\nfunction trim(str){\n  return str.replace(/^\\s*|\\s*$/g, '');\n}\n\nexports.left = function(str){\n  return str.replace(/^\\s*/, '');\n};\n\nexports.right = function(str){\n  return str.replace(/\\s*$/, '');\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/trim/index.js\n// module id = 34\n// module chunks = 0","var isFunction = require('is-function')\n\nmodule.exports = forEach\n\nvar toString = Object.prototype.toString\nvar hasOwnProperty = Object.prototype.hasOwnProperty\n\nfunction forEach(list, iterator, context) {\n    if (!isFunction(iterator)) {\n        throw new TypeError('iterator must be a function')\n    }\n\n    if (arguments.length < 3) {\n        context = this\n    }\n    \n    if (toString.call(list) === '[object Array]')\n        forEachArray(list, iterator, context)\n    else if (typeof list === 'string')\n        forEachString(list, iterator, context)\n    else\n        forEachObject(list, iterator, context)\n}\n\nfunction forEachArray(array, iterator, context) {\n    for (var i = 0, len = array.length; i < len; i++) {\n        if (hasOwnProperty.call(array, i)) {\n            iterator.call(context, array[i], i, array)\n        }\n    }\n}\n\nfunction forEachString(string, iterator, context) {\n    for (var i = 0, len = string.length; i < len; i++) {\n        // no such thing as a sparse string.\n        iterator.call(context, string.charAt(i), i, string)\n    }\n}\n\nfunction forEachObject(object, iterator, context) {\n    for (var k in object) {\n        if (hasOwnProperty.call(object, k)) {\n            iterator.call(context, object[k], k, object)\n        }\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/for-each/index.js\n// module id = 35\n// module chunks = 0","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/xtend/immutable.js\n// module id = 36\n// module chunks = 0"],"sourceRoot":""}